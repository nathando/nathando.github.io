<!DOCTYPE html>
<html>
  <head>
    <title>Development with ERPNext - Part 1: Setup using Vagrant box – Nathan Do – life_of.py</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="One thing that was quite impressive when I first started working with ERPNext was the underlying Frappe Framework. It is highly extensible multi-tenant platform. In a way, Frappe acts as a host for all other apps to run on top, including ERPNext itself.

" />
    <meta property="og:description" content="One thing that was quite impressive when I first started working with ERPNext was the underlying Frappe Framework. It is highly extensible multi-tenant platform. In a way, Frappe acts as a host for all other apps to run on top, including ERPNext itself.

" />
    
    <meta name="author" content="Nathan Do" />

    
    <meta property="og:title" content="Development with ERPNext - Part 1: Setup using Vagrant box" />
    <meta property="twitter:title" content="Development with ERPNext - Part 1: Setup using Vagrant box" />
    
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-87712266-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-87712266-1');
</script>


    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="https://fonts.googleapis.com/css?family=Droid+Sans|Encode+Sans|Anaheim" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/plugins/foundation/foundation.min.css" />
    <link rel="stylesheet" type="text/css" href="/plugins/simple-line-icons/css/simple-line-icons.css" />
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Nathan Do - life_of.py" href="/feed.xml" />
    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>

  <body>
    <div class="header">
  <div class="grid-container">
    <div class="grid-x grid-padding-x grid-padding-y">
      <header class="large-12 cell">
        <a href="/" class="site-avatar"><img src="https://avatars3.githubusercontent.com/u/1678810?s=100" /></a>

        <div class="site-info">
          <h1 class="site-name"><a href="/">Nathan Do</a></h1>
          <p class="site-description">life_of.py</p>
        </div>

        <nav class="main-nav">
          <a href="/tag/tech">Tech</a>
          <a href="/tag/life">Life</a>
          <!-- Language switcher -->
          
            
            <a id="btn-lang" data-toggle="lang-switcher" href="#" aria-expanded="true">
              <img class="flag-img" src="/images/flags/uk.png">
            </a>
            
          
            
          
          <ul id="lang-switcher" class="dropdown-pane" data-dropdown
              data-position="bottom" data-alignment="right" data-v-offset="10" >
            
              
              
              <li>
                <a class="flag-link" href="/">
                    <img class="flag-img" src="/images/flags/uk.png">
                    <span>English</span>
                </a>
              </li>
            
              
              
              <li>
                <a class="flag-link" href="/vn">
                    <img class="flag-img" src="/images/flags/vn.png">
                    <span>Vietnamese</span>
                </a>
              </li>
            
          </ul>
        </nav>


      </header>
    </div>
  </div>
</div>

    <div id="main" role="main" class="grid-container">
      <article class="post">
  <h1 class="post-title">Development with ERPNext - Part 1: Setup using Vagrant box</h1>
  <hr class="post-title-sep">

  <div class="entry">
    <p>One thing that was quite impressive when I first started working with ERPNext was the underlying <strong>Frappe</strong> Framework. It is highly extensible multi-tenant platform. In a way, Frappe acts as a host for all other apps to run on top, including ERPNext itself.</p>

<p>For reference, here is the official <a href="http://frappe.github.io/erpnext/user/manual/en/">User Manual</a> from ERPNext.</p>

<p>Following this though, I still found it hard to have everything set up nicely for development. There are 2 approaches I took:</p>

<ol>
  <li>Install <code>bench</code> directly on my Macbook. Problem with this arrives if we wanna have different version of <em>ERPNext/Frappe</em>. There is no way to make it clean</li>
  <li>Install using <strong>VirtualBox/Vagrant</strong>. It solves the first problem but then there is no actual documentation on how to set it up for development.</li>
</ol>

<p>Therefore i will try to show how I set up mine using Vagrant Box in this post. It turns out to be pretty simple and convenient.</p>

<h3 id="setup">Setup</h3>
<h5 id="1-download-vagrant-box">1. Download Vagrant box</h5>
<p>For simplicity, I will skip the step on how to install Vagrant/Virtual Box. Just make sure you have those installed. The official vagrant box is here: https://erpnext.com/download</p>

<h5 id="2-add-vagrant-box-and-start-the-vm">2. Add vagrant box and start the vm</h5>
<p>Usually i will put the box in my project folder as follow:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">project_a</span><span class="o">/</span>
<span class="o">----</span> <span class="n">code</span><span class="o">/</span>
<span class="o">----</span> <span class="no">ERPNext</span><span class="o">-</span><span class="no">Vagrant</span><span class="p">.</span><span class="nf">box</span></code></pre></figure>

<p>Open a Command Terminal on the downloaded location, and add the vagrant box</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">vagrant</span> <span class="n">box</span> <span class="n">add</span> <span class="no">ERPNext</span><span class="o">-</span><span class="no">Vagrant</span><span class="p">.</span><span class="nf">box</span> <span class="o">--</span><span class="nb">name</span><span class="o">=</span><span class="no">ERPNextTest</span></code></pre></figure>

<p>To see if it is actually added:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">vagrant</span> <span class="n">box</span> <span class="n">list</span>
<span class="o">-----</span>
<span class="no">ERPNextTest</span>   <span class="p">(</span><span class="n">virtualbox</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></code></pre></figure>

<p>Next add the following simple <code>Vagrantfile</code> in the same folder as the box with the following content:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">Vagrant</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="s2">"2"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">box</span> <span class="o">=</span> <span class="s2">"ERPNextTest"</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="s2">"private_network"</span><span class="p">,</span> <span class="ss">ip: </span><span class="s2">"192.168.50.5"</span>
<span class="k">end</span></code></pre></figure>

<p><a href="https://www.vagrantup.com/docs/vagrantfile/">Vagrantfile</a> is used to inform Vagrant on how to provision the vm. I have chosen Static IP instead of DHCP to avoid the need to find IP later. More on Vagrant network configuration <a href="https://www.vagrantup.com/docs/networking/private_network.html">here</a>.</p>

<p>Next let’s just start up the box with:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">vagrant</span> <span class="n">up</span></code></pre></figure>

<h4 id="3-copy-the-bench-folder-out">3. Copy the bench folder out</h4>
<p>After the box finishes setting up, we can take a look by ssh in <code>vagrant ssh</code>. It will look something like this when we do a list out.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">To</span> <span class="n">update</span><span class="p">,</span> <span class="n">login</span> <span class="n">as</span>
<span class="ss">username: </span><span class="n">frappe</span>
<span class="ss">password: </span><span class="n">frappe</span>
<span class="o">....</span>
<span class="no">Last</span> <span class="ss">login: </span><span class="no">Wed</span> <span class="no">Dec</span>  <span class="mi">7</span> <span class="mo">04</span><span class="p">:</span><span class="mi">42</span><span class="p">:</span><span class="mi">10</span> <span class="mi">2016</span> <span class="n">from</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">2.2</span>
<span class="n">frappe</span><span class="vi">@erpnext</span><span class="ss">:~</span><span class="err">$</span> <span class="n">ls</span>
<span class="n">bench</span><span class="o">-</span><span class="n">repo</span>  <span class="n">frappe</span><span class="o">-</span><span class="n">bench</span>  <span class="n">tmp</span>
<span class="n">frappe</span><span class="vi">@erpnext</span><span class="ss">:~</span><span class="err">$</span> <span class="n">ll</span> <span class="n">frappe</span><span class="o">-</span><span class="n">bench</span><span class="o">/</span>
<span class="n">total</span> <span class="mi">20</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span> <span class="mi">1</span> <span class="n">frappe</span> <span class="n">frappe</span>  <span class="mi">374</span> <span class="no">Dec</span>  <span class="mi">6</span> <span class="mi">10</span><span class="p">:</span><span class="mi">22</span> <span class="p">.</span><span class="nf">/</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span> <span class="mi">9</span> <span class="n">frappe</span> <span class="n">frappe</span> <span class="mi">4096</span> <span class="no">Dec</span>  <span class="mi">6</span> <span class="mi">10</span><span class="p">:</span><span class="mi">09</span> <span class="o">..</span><span class="sr">/
drwxrwxr-x 1 frappe frappe  170 Dec  6 10:15 apps/</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span> <span class="mi">1</span> <span class="n">frappe</span> <span class="n">frappe</span>  <span class="mi">204</span> <span class="no">Dec</span>  <span class="mi">6</span> <span class="mi">10</span><span class="p">:</span><span class="mi">15</span> <span class="n">config</span><span class="o">/</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">frappe</span> <span class="n">frappe</span> <span class="mi">6148</span> <span class="no">Dec</span>  <span class="mi">6</span> <span class="mi">10</span><span class="p">:</span><span class="mi">15</span> <span class="o">.</span><span class="no">DS_Store</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span> <span class="mi">1</span> <span class="n">frappe</span> <span class="n">frappe</span>  <span class="mi">340</span> <span class="no">Dec</span>  <span class="mi">6</span> <span class="mi">10</span><span class="p">:</span><span class="mi">17</span> <span class="n">env</span><span class="o">/</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span> <span class="mi">1</span> <span class="n">frappe</span> <span class="n">frappe</span>  <span class="mi">170</span> <span class="no">Dec</span>  <span class="mi">7</span> <span class="mi">09</span><span class="p">:</span><span class="mi">55</span> <span class="n">logs</span><span class="o">/</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span> <span class="mi">1</span> <span class="n">frappe</span> <span class="n">frappe</span>  <span class="mi">238</span> <span class="no">Dec</span>  <span class="mi">6</span> <span class="mi">10</span><span class="p">:</span><span class="mi">15</span> <span class="n">node_modules</span><span class="o">/</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">frappe</span> <span class="n">frappe</span>  <span class="mi">128</span> <span class="no">Dec</span>  <span class="mi">6</span> <span class="mi">10</span><span class="p">:</span><span class="mi">14</span> <span class="n">patches</span><span class="p">.</span><span class="nf">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">frappe</span> <span class="n">frappe</span>  <span class="mi">405</span> <span class="no">Dec</span>  <span class="mi">6</span> <span class="mi">10</span><span class="p">:</span><span class="mi">15</span> <span class="no">Procfile</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span> <span class="mi">1</span> <span class="n">frappe</span> <span class="n">frappe</span>  <span class="mi">238</span> <span class="no">Dec</span>  <span class="mi">6</span> <span class="mi">10</span><span class="p">:</span><span class="mi">16</span> <span class="n">sites</span><span class="o">/</span>
<span class="n">frappe</span><span class="vi">@erpnext</span><span class="ss">:~</span><span class="err">$</span> </code></pre></figure>

<p>Now the main problem now is how to access these files as local files. Vagrant has a configuration called <code>synced_folders</code>. This, however, will prioritize syncing from host machine to guest. So if you have an empty host folder, it will screw up the initial setting from ERPNext. <em>My solution is simple: wait for the <code>frappe-bench</code> folder to finish setting up, then copy it out and sync.</em></p>

<p>Remember the static ip above, it will be useful here, we use scp to copy the whole folder out. Because it’s a local server, it’s pretty fast.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">scp</span> <span class="o">-</span><span class="n">r</span> <span class="n">frappe</span><span class="err">@</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">50.5</span><span class="ss">:~</span><span class="o">/</span><span class="n">frappe</span><span class="o">-</span><span class="n">bench</span><span class="o">/</span> <span class="n">code</span></code></pre></figure>

<p>Anyway, as long as the copying’s done, it will be much better because we can continue use git on these local files and still have it synced to the VM.</p>

<p>We can use tar for this as well:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">ssh</span> <span class="n">frappe</span><span class="err">@</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">50.5</span> <span class="s1">'cd ~/frappe-bench &amp;&amp; tar czvf - .'</span> <span class="o">|</span> <span class="n">tar</span> <span class="n">xzf</span> <span class="o">-</span> <span class="o">-</span><span class="no">C</span> <span class="p">.</span><span class="nf">/</span><span class="n">code</span></code></pre></figure>

<h4 id="4-last-step-is-to-enable-synced_folder">4. Last step is to enable synced_folder</h4>
<p>Add a line to your <code>Vagrantfile</code> so that it looks like below:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">Vagrant</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="s2">"2"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">box</span> <span class="o">=</span> <span class="s2">"ERPNextTest"</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="s2">"private_network"</span><span class="p">,</span> <span class="ss">ip: </span><span class="s2">"192.168.50.5"</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">synced_folder</span> <span class="s2">"code/"</span><span class="p">,</span> <span class="s2">"/home/frappe/frappe-bench"</span>
<span class="k">end</span></code></pre></figure>

<p>Next, <code>vagrant reload</code>. 
After this you will have a local folder that automatically synced to the Vagrant Box. Any changes made to the apps will be updated. At the same time, since those files are local, you can still make use of the git versioning as usual. So there you have it, my one simple trick to set up ERPNext development environment using Vagrant Box.</p>

<p>This is much cleaner than directly install on Host machine, be it Mac or Windows (because of multi-versions conflict) and also quite convenient compare to keep updating a file from editor and upload the vagrant box.</p>

  </div>

  <div class="date">
    Written on December 21, 2016
  </div>

  
<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">

	    var disqus_shortname = 'nathandlb-com';

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();

	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

</article>

    </div>
    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          



<a target="_blank" href="https://github.com/nathando"><i class="svg-icon github"></i></a>

<a target="_blank" href="https://www.linkedin.com/in/nathando"><i class="svg-icon linkedin"></i></a>


<a target="_blank" href="https://www.twitter.com/nathandlb"><i class="svg-icon twitter"></i></a>
<a target="_blank" href="http://stackoverflow.com/users/1149484/nathan-do"><i class="svg-icon stackoverflow"></i></a>


<a target="_blank" href="https://www.quora.com/profile/Nathan-Do"><i class="svg-icon quora"></i></a>

        </footer>
      </div>
    </div>

    
	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-104939362-1', 'auto');
		ga('send', 'pageview', {
		  'page': '/2016/12/21/ERPNext-development-part-1.html',
		  'title': 'Development with ERPNext - Part 1: Setup using Vagrant box'
		});
	</script>
	<!-- End Google Analytics -->


    <script type="text/javascript" src="/plugins/jquery/jquery.js"></script>
    <script type="text/javascript" src="/plugins/foundation/foundation.min.js"></script>
    <script type="text/javascript" src="/js/main.js"></script>
  </body>
</html>
